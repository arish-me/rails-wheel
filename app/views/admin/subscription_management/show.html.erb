<div class="container mx-auto px-4 py-8">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Subscription Management</h1>
    <%= link_to "← Back to List", admin_subscription_management_index_path, 
        class: "text-indigo-600 hover:text-indigo-900" %>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Company Information -->
    <div class="bg-white shadow rounded-lg p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Company Information</h2>
      <div class="space-y-3">
        <div>
          <label class="text-sm font-medium text-gray-500">Company Name</label>
          <p class="text-sm text-gray-900"><%= @company.name %></p>
        </div>
        <div>
          <label class="text-sm font-medium text-gray-500">Website</label>
          <p class="text-sm text-gray-900"><%= @company.website %></p>
        </div>
        <div>
          <label class="text-sm font-medium text-gray-500">Users</label>
          <p class="text-sm text-gray-900"><%= @company.users.count %></p>
        </div>
        <div>
          <label class="text-sm font-medium text-gray-500">Created</label>
          <p class="text-sm text-gray-900"><%= @company.created_at.strftime("%b %d, %Y") %></p>
        </div>
      </div>
    </div>

    <!-- Subscription Information -->
    <div class="bg-white shadow rounded-lg p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Subscription Details</h2>
      <% if @subscription %>
        <div class="space-y-3">
          <div>
            <label class="text-sm font-medium text-gray-500">Status</label>
            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full
              <%= case @subscription.status
                  when 'active'
                    'bg-green-100 text-green-800'
                  when 'trial'
                    'bg-amber-100 text-amber-800'
                  when 'expired'
                    'bg-red-100 text-red-800'
                  else
                    'bg-gray-100 text-gray-800'
                  end %>">
              <%= @subscription.status.titleize %>
            </span>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-500">Plan</label>
            <p class="text-sm text-gray-900"><%= @subscription.plan_name %></p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-500">Price</label>
            <p class="text-sm text-gray-900"><%= @subscription.display_price %></p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-500">Start Date</label>
            <p class="text-sm text-gray-900"><%= @subscription.start_date.strftime("%b %d, %Y") %></p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-500">End Date</label>
            <p class="text-sm text-gray-900"><%= @subscription.end_date.strftime("%b %d, %Y") %></p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-500">Days Remaining</label>
            <p class="text-sm text-gray-900"><%= @subscription.days_remaining %></p>
          </div>
        </div>
      <% else %>
        <p class="text-sm text-gray-500">No subscription found</p>
      <% end %>
    </div>
  </div>

  <!-- Subscription Actions -->
  <% if @subscription %>
    <div class="mt-8 bg-white shadow rounded-lg p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Subscription Actions</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Upgrade to Paid -->
        <div class="border border-gray-200 rounded-lg p-4">
          <h3 class="text-lg font-medium text-gray-900 mb-2">Upgrade to Paid</h3>
          <p class="text-sm text-gray-600 mb-4">Convert trial to paid subscription</p>
          <%= form_with url: upgrade_admin_subscription_management_path(@company), method: :post, local: true do |form| %>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700 mb-2">Duration (months)</label>
              <%= form.select :duration_months, options_for_select([1, 3, 6, 12], 1), {}, 
                  class: "w-full border border-gray-300 rounded-md px-3 py-2" %>
            </div>
            <%= form.submit "Upgrade", 
                class: "w-full bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition duration-200" %>
          <% end %>
        </div>

        <!-- Extend Trial -->
        <div class="border border-gray-200 rounded-lg p-4">
          <h3 class="text-lg font-medium text-gray-900 mb-2">Extend Trial</h3>
          <p class="text-sm text-gray-600 mb-4">Add more days to trial period</p>
          <%= form_with url: extend_trial_admin_subscription_management_path(@company), method: :post, local: true do |form| %>
            <div class="mb-4">
              <label class="block text-sm font-medium text-gray-700 mb-2">Additional Days</label>
              <%= form.select :days, options_for_select([7, 14, 30, 60], 30), {}, 
                  class: "w-full border border-gray-300 rounded-md px-3 py-2" %>
            </div>
            <%= form.submit "Extend Trial", 
                class: "w-full bg-amber-600 text-white px-4 py-2 rounded-md hover:bg-amber-700 transition duration-200" %>
          <% end %>
        </div>

        <!-- Cancel Subscription -->
        <div class="border border-gray-200 rounded-lg p-4">
          <h3 class="text-lg font-medium text-gray-900 mb-2">Cancel Subscription</h3>
          <p class="text-sm text-gray-600 mb-4">Cancel and expire subscription</p>
          <%= form_with url: cancel_admin_subscription_management_path(@company), method: :post, local: true do |form| %>
            <%= form.submit "Cancel", 
                class: "w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition duration-200",
                data: { confirm: "Are you sure you want to cancel this subscription?" } %>
          <% end %>
        </div>
      </div>
    </div>
  <% else %>
    <!-- Create Trial -->
    <div class="mt-8 bg-white shadow rounded-lg p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Create Trial</h2>
      <p class="text-sm text-gray-600 mb-4">This company doesn't have a subscription yet.</p>
      <%= button_to "Create 30-Day Trial", "#", 
          class: "bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200",
          disabled: true %>
    </div>
  <% end %>
</div>

